# SQLite Data Manager - Claude Project Context

## プロジェクト概要
SAP生産データの自動取り込み・型推定・正規化を行うSQLite基盤のデータ管理システム

## 現在の状況 (2024-09-10 継続作業 - パターンルールシステム動作検証完了)
- **Phase**: T002データ型修正支援ツール開発 - Phase 1完了
- **優先度**: 最優先プロジェクト
- **進捗**: 
  - ✅ T001完了: compare_report.csv詳細分析済み（2,428フィールド、一致率89.5%）
  - ✅ T002基盤完成: 4つの問題パターン特定・テスト環境構築済み
  - ✅ **パターンルールシステム動作検証完了**: 
    - 14種類のパターンルールが正常動作
    - 文字エンコード問題も解決
    - 各種データ型（TEXT, INTEGER, REAL, DATE）の自動判定が完璧
- **GitHub**: https://github.com/k66-keroro/sqlite-data-manager
- **Issue管理**: GitHub Issues で T001-T006 を管理中（ベースラベル）
- **現在のタスク**: CSV/Excel処理との統合準備も完了して
いる。新しいチャットを開始した際には、このファイル（claude.md）と今確認したパター
ンルールシステムを参考に、GUI統合作業を進めることができます。

## 主要課題
1. **データ型整理の躓き**: 2,400+フィールドの型統合
2. **情シス側の統一性なし**: エンコーディング、区切り文字、拡張子、フィールド名がバラバラ
3. **SAPデータの特殊性**: 0パディング、後ろマイナス、同一データでも複数ファイルで形式混在

## 技術スタック
- **Backend**: Python + SQLite
- **Data Processing**: pandas
- **Frontend（予定）**: Streamlit
- **Version Control**: GitHub

## 開発方針
- 段階的アプローチで着実に進める
- 既存のコード資産を無駄にしない
- 自動化重視（手作業を最小限に）

## 完了済み成果 (2024-09-10更新)
### T001成果
- **詳細分析完了**: 2,428フィールド中256件(10.5%)の型不一致を特定
- **問題パターン分類**: 4つの主要パターンを特定・対策案策定
- **SAP特殊ルール発見**: 後ろマイナス256フィールド、0パディング16フィールド
- **重複フィールド**: 1,822ユニーク列名、316種類の重複パターン

### T002基盤成果  
- **テスト環境**: t002_test.py完成、1000×25列での動作確認済み
- **4つの問題特定**: 未登録型、DATETIME→TEXT、INTEGER→TEXT、保管場所コード
- **修正方針確定**: pattern_rules.jsonによる自動修正アプローチ

### ✅ **パターンルールシステム動作検証完了**
- **14種類のパターンルールが正常動作**
  - 14種類のパターンルールが正常動作
  - 文字エンコード問題も解決
  - 各種データ型（TEXT, INTEGER, REAL, DATE）の自動判定が完璧

## 次の作業への準備
claude.mdファイルの情報によると、次の優先作業は：

1. **Part1-Part4ファイルの最終統合（最高優先度）**
2. **完全なSQLite_GUI_Manager.py作成**
3. **GUI全体の動作確認・デバッグ**

現在のパターンルールシステムは完璧に動作しており、CSV/Excel処理との統合準備も完了して
います。新しいチャットを開始した際には、このファイル（claude.md）と今確認したパター
ンルールシステムを参考に、GUI統合作業を進めることができます。

## ファイル構成
```
sqlite-data-manager/
├── main.py              # エントリポイント
├── config.py           # 設定管理
├── analyzer.py         # データ分析・型推定
├── loader.py           # ファイル読み込み（最新修正済み）
├── init_dev.py         # 開発環境初期化
├── init_prod.py        # 本番環境初期化
├── mapper.py           # データマッピング
├── db.py              # DB操作
├── master_manager.py  # マスタ管理
├── t001_analyzer.py   # T001分析ツール（完成）
├── t002_analyzer.py   # T002問題特定ツール（開発中）
├── t002_test.py      # T002テスト環境（完成）
├── T001_analysis_report.md # T001詳細分析結果
├── pattern_rules_sample.json # 修正ルールサンプル（予定）
├── output/            # 出力ディレクトリ
│   ├── master.db     # SQLiteDB
│   └── compare_report.csv # 型比較結果（分析完了）
└── テキスト/          # 入力データ（40ファイル中39成功）
```

## 重要メモ
- データが0行の場合は異常検出のトリガーファイル（正常動作）
- 毎日のデータ更新を想定したシステム設計
- イレギュラー処理・新ファイル増加への対応が必要
- **GitHub Issues**: T001-T006でタスク管理中
- **ラベル体系**: ベース（基盤機能）、機能拡張、バグ修正など

## GitHub リポジトリ情報
- **URL**: https://github.com/k66-keroro/sqlite-data-manager
- **ブランチ**: main
- **Issue管理**: 実装済み
- **プロジェクト管理**: GitHub Issues + タスクラベル
